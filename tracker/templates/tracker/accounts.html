{% extends 'tracker/index.html' %}
{% load static %}
{% load num_filters %}

{% block header %}
		{% if customer %}
			<h1>{{ customer.name }} &#8212; #{{ customer.acct }}</h1>
		{% else %}
			<h1>Tracker &#8212; {{ head_text }} ({{ num_accts }})</h1>
		{% endif %}
{% endblock header %}

{% block content %}

	{% if confirm_remove %}
		<a href="/accounts?remove={{ customer.acct }}&confirm_remove=True">Yes</a>
		<a href="/accounts">No</a>
	{% endif %}

	<a href="/accounts?accts=all">All accounts</a>
	| <a href="/accounts?accts=active">Active accounts</a>
	| <a href="/accounts?accts=inactive">Inactive accounts</a>
	| <a href="/add_account">Add new account</a>
	{% if customer %}
		{% if account_status == 'Active' %}
			| <a href="/accounts?remove={{ customer.acct }}">Remove account</a>
		{% endif %}
	{% endif %}

	{% if messages %}
		<ul class="message">
		{% for message in messages %}
			<li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
		{% endfor %}
		</ul>
	{% else %}
		<br/><br/>
{#		very nice#}
	{% endif %}

	{% if customer_list %}
		<br/><br/><table>
			<tr>
				{% for item in headers %}
					<th>{{ item }}</th>
				{% endfor %}
			</tr>
		{% for customer in customer_list %}
			<tr>
				<td id="account_cell"><a href="{{ customer.url }}">{{ customer.acct }}</a></td>
				<td id="name_cell">{{ customer.name }}</td>
				{% if status_column %}
					<td id="status_cell">{{ customer.status }}</td>
				{% endif %}
				<td id="open_date">{{ customer.createdate|date:"M d, Y" }}</td>
				{% if customer.status == "0" %}
					<td id="close_date">{{ customer.closedate|date:"M d, Y" }}</td>
				{% else %}
					<td class="inactive"></td>
				{% endif %}
			</tr>
		{% endfor %}
		</table>

	{% elif customer %}
		<table>
			<tr>
				{% for item in headers %}
					<th>{{ item }}</th>
				{% endfor item %}
			</tr>
			<tr>
				<td id="account_cell">{{ customer.acct }}</td>
				<td id="name_cell">{{ customer.name }}</td>
				<td id="email_cell">{{ customer.email }}</td>
				<td id="status_cell">{{ account_status }}</td>
				<td id="open_date">{{ customer.createdate|date:"M d, Y" }}</td>
				{% if customer.status == '0' %}
					<td id="close_date">{{ customer.closedate|date:"M d, Y" }}</td>
				{% endif %}
			</tr>
		</table>
	{% endif %}

	<br/><a href="/inventory?acct={{ customer.acct }}&status=stored">Manage Inventory</a>
	| <a href="/inventory?acct={{ customer.acct }}&status=all">Inventory Report</a>
	{% if storage_fees %}
		| Daily storage fees as of today: ${{ storage_fees|length:"2" }}<br/>
	{% else %}
		| Daily storage fees as of today: $0.00<br/>
	{% endif %}
	<br/><table>
		<tr>
			{% for item in inv_headers %}
				<th>{{ item }}</th>
			{% endfor %}
		</tr>
		{% if inventory_list %}
			{% for item in inventory_list %}
				<tr>
					<td id="item_id">
						<a href="/inventory?item={{ item.itemid }}">{{ item.itemid }}</a>
					</td>
					<td id="item_quantity">{{ item.quantity }}</td>
					<td id="item_volume">{{ item.volume|length:"2" }}</td>
					<td id="item_storage_fees">${{ item.storage_fees|length:"2" }}</td>
					<td id="item_status">{{ item.status|op_code }}</td>
					<td id="item_arrival">{{ item.arrival|date:"m-d-Y" }}</td>
				</tr>
			{% endfor %}
		{% endif %}
	</table>

	{% if error_message %}
		<p id="error_message">{{ error_message }}</p>
	{% endif %}

{% endblock content %}
